// –§—É–Ω–∫—Ü–∏—è race –ø—Ä–∏–Ω–∏–º–∞–µ—Ç iterable, –Ω–∞–ø—Ä–∏–º–µ—Ä, Array –∏–ª–∏ Set. –£ iterable –Ω–µ—Ç –¥–ª–∏–Ω—ã, –Ω–æ,
// –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –Ω–µ–º—É –º–æ–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ —Ü–∏–∫–ª–æ–º for-of.
// –§—É–Ω–∫—Ü–∏—è race –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–º–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏
// —Å—Ç–∞—Ç—É—Å–æ–º –ø–µ—Ä–≤–æ–≥–æ –∑–∞–≤–µ—Ä—à–∏–≤—à–µ–≥–æ—Å—è –ø—Ä–æ–º–∏—Å–∞ –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏. –ï—Å–ª–∏ –≤ iterable –µ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã,
// –Ω–µ —è–≤–ª—è—é—â–∏–µ—Å—è –ø—Ä–æ–º–∏—Å–æ–º, —Ç–æ
// –∏—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–º–∏—Å –∑–∞—Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –ø–µ—Ä–≤—ã–º –∏–∑ –Ω–∏—Ö.

// –ü—Ä–∏–º–µ—Ä 1
// p1 —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üêé" —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
// p2 —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üê¢" —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
// p3 —Ä–µ–¥–∂–µ–∫—Ç–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üëª" —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
// –¢–æ–≥–¥–∞ race –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —ç—Ç–∏ –ø—Ä–æ–º–∏—Å—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–º–∏—Å. –ß–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –æ–Ω —Ä–µ–¥–∂–µ–∫—Ç–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üëª"

// –ü—Ä–∏–º–µ—Ä 2
// –¢–µ–ø–µ—Ä—å –ø—É—Å—Ç—å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ 3 —Ç–∞–∫–∏—Ö –ø—Ä–æ–º–∏—Å–∞:

// p1 —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üêé" —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
// p2 —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üê¢" —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
// p3 —Ä–µ–¥–∂–µ–∫—Ç–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üëª" —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
// –¢–æ–≥–¥–∞ race –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —ç—Ç–∏ –ø—Ä–æ–º–∏—Å—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–º–∏—Å. –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –æ–Ω —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üêé"

const rand = () => Math.random() * 2000;

const p1 = new Promise((r) => setTimeout(r, rand(), "A"));
const p2 = new Promise((r) => setTimeout(r, rand(), "B"));
const p3 = new Promise((r) => setTimeout(r, rand(), "C"));
const p4 = new Promise((r) => setTimeout(r, rand(), "D"));

race([p1, p2, p3, p4]).then(
  (value) => console.log("1 >>>", value),
  (reason) => console.log("2 >>>", reason)
);

race([1, 2, 3]).then((res) => console.log(res));

function race(iterable) {
  return new Promise((resolve, reject) => {
    let hasElements = false;

    for (const item of iterable) {
      hasElements = true;

      // –ù–µ-–ø—Ä–æ–º–∏—Å—ã —Ä–µ–∑–æ–ª–≤—è—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
      if (!(item instanceof Promise)) {
        resolve(item);
        return; // –ú–æ–∂–Ω–æ –≤—ã–π—Ç–∏ (—Ö–æ—Ç—è Promise –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã)
      }

      // –ü—Ä–æ–º–∏—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
      item.then(resolve, reject);
    }

    // –ï—Å–ª–∏ iterable –ø—É—Å—Ç–æ–π - –ø—Ä–æ–º–∏—Å –≤–∏—Å–∏—Ç –≤–µ—á–Ω–æ
    // (–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º)
  });
}
