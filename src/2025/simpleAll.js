// –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ Promise.all.

// –î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ –ø—Ä–æ–º–∏—Å–∞:

// p1 —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üçé" —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
// p2 —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üçã" —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
// p3 —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º "üçâ" —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
// –§—É–Ω–∫—Ü–∏—è all –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –ø—Ä–æ–º–∏—Å–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–º–∏—Å.
// –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –æ–Ω —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –º–∞—Å–∏–≤–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–∏—Å–æ–≤. –ü–æ—Ä—è–¥–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–∫—É –ø—Ä–æ–º–∏—Å–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ.

// –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –≤—Ö–æ–¥—è—â–∏–µ –ø—Ä–æ–º–∏—Å—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ç–∞–Ω—É—Ç rejected.

const rand = () => Math.random() * 2000;

const p1 = new Promise((r) => setTimeout(r, rand(), "A"));
const p2 = new Promise((r) => setTimeout(r, rand(), "B"));
const p3 = new Promise((r) => setTimeout(r, rand(), "C"));
const p4 = new Promise((r) => setTimeout(r, rand(), "D"));

all([p1, p2, p3]).then((arr) => {
  console.log(arr); // arr === ["üçé", "üçã", "üçâ"]
});

function all(promises) {
  return new Promise((resolve, reject) => {
    const inner = Array.from(promises);

    if (inner.length === 0) {
      resolve([]);
      return;
    }

    let result = [];
    let count = 0;
    const promiseLength = inner.length;

    for (let i = 0; i < inner.length; i++) {
      // Promise.resolve() –æ–±–µ—Ä–Ω—ë—Ç –∏ –ø—Ä–æ–º–∏—Å—ã, –∏ –Ω–µ–ø—Ä–æ–º–∏—Å—ã
      Promise.resolve(inner[i])
        .then((value) => {
          result[i] = value;
          count++;
          if (count === promiseLength) {
            resolve(result);
          }
        })
        .catch(reject); // –ö–æ—Ä–æ—á–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ
    }
  });
}
